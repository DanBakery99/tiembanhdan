import{i as p}from"./data-D_QJL9HF.js";let a=localStorage.getItem("siteData")?JSON.parse(localStorage.getItem("siteData")):JSON.parse(JSON.stringify(p));const d=e=>new Promise((t,n)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=r=>{const s=new Image;s.src=r.target.result,s.onload=()=>{const l=document.createElement("canvas"),u=800,g=u/s.width;l.width=u,l.height=s.height*g,l.getContext("2d").drawImage(s,0,0,l.width,l.height),t(l.toDataURL("image/jpeg",.7))},s.onerror=l=>n(l)},o.onerror=r=>n(r)}),h=document.getElementById("login-modal"),y=document.getElementById("admin-dashboard"),v=document.getElementById("login-form"),b=document.getElementById("login-error");v.addEventListener("submit",e=>{e.preventDefault(),document.getElementById("password").value==="Toobakery0810"?(h.classList.add("hidden"),y.classList.remove("hidden"),w()):b.classList.remove("hidden")});document.getElementById("logout-btn").addEventListener("click",()=>{location.reload()});const m=document.querySelectorAll(".tab-btn"),f=document.querySelectorAll(".tab-content");m.forEach(e=>{e.addEventListener("click",()=>{m.forEach(t=>{t.classList.remove("bg-primary","text-white"),t.classList.add("text-gray-600","hover:bg-white","hover:text-primary")}),e.classList.remove("text-gray-600","hover:bg-white","hover:text-primary"),e.classList.add("bg-primary","text-white"),f.forEach(t=>t.classList.add("hidden")),document.getElementById(`tab-${e.dataset.tab}`).classList.remove("hidden")})});const w=()=>{i(),c(),I(),E()},i=()=>{const e=document.getElementById("menu-list");e.innerHTML="",a.menu.items.forEach((t,n)=>{const o=document.createElement("div");o.className="bg-gray-50 p-4 rounded-lg flex flex-col md:flex-row gap-4 items-start shadow-sm border border-gray-100",o.innerHTML=`
            <div class="w-full md:w-32 h-32 flex-shrink-0 bg-gray-200 rounded-lg overflow-hidden group relative">
                <img src="${t.image}" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-black/50 hidden group-hover:flex items-center justify-center cursor-pointer" onclick="document.getElementById('menu-file-${n}').click()">
                    <span class="text-white text-xs text-center px-1">ƒê·ªïi ·∫¢nh</span>
                </div>
            </div>
            <div class="flex-1 space-y-3 w-full">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <input type="text" value="${t.name}" placeholder="T√™n m√≥n" class="p-2 border rounded w-full text-sm font-bold" onchange="updateMenuItem(${n}, 'name', this.value)">
                    <input type="text" value="${t.price}" placeholder="Gi√°" class="p-2 border rounded w-full text-sm" onchange="updateMenuItem(${n}, 'price', this.value)">
                </div>
                <input type="text" value="${t.description}" placeholder="M√¥ t·∫£" class="p-2 border rounded w-full text-sm" onchange="updateMenuItem(${n}, 'description', this.value)">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 items-center">
                     <div class="flex gap-2 items-center">
                        <input type="text" value="${t.image}" placeholder="URL H√¨nh ·∫£nh" class="p-2 border rounded w-full text-sm text-gray-500 flex-1" onchange="updateMenuItem(${n}, 'image', this.value)">
                        <input type="file" id="menu-file-${n}" class="hidden" accept="image/*" onchange="uploadMenuImage(${n}, this)">
                        <button onclick="document.getElementById('menu-file-${n}').click()" class="bg-gray-200 hover:bg-gray-300 px-3 py-2 rounded text-xs whitespace-nowrap">Upload</button>
                     </div>
                     <input type="text" value="${t.tag||""}" placeholder="Tag (e.g. Best Seller)" class="p-2 border rounded w-full text-sm" onchange="updateMenuItem(${n}, 'tag', this.value)">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <select class="p-2 border rounded w-full text-sm" onchange="updateMenuItem(${n}, 'category', this.value)">
                        <option value="b√°nh ng·ªçt" ${t.category==="b√°nh ng·ªçt"?"selected":""}>üç∞ B√°nh Ng·ªçt</option>
                        <option value="ƒë·ªì u·ªëng" ${t.category==="ƒë·ªì u·ªëng"?"selected":""}>‚òï ƒê·ªì U·ªëng</option>
                        <option value="m√≥n m·∫∑n" ${t.category==="m√≥n m·∫∑n"?"selected":""}>üçî M√≥n M·∫∑n</option>
                    </select>
                    <div class="text-xs text-gray-500 flex items-center px-2">
                        <span>Ph√¢n lo·∫°i: <strong>${t.category||"ch∆∞a ch·ªçn"}</strong></span>
                    </div>
                </div>
            </div>
            <button onclick="deleteMenuItem(${n})" class="text-red-500 hover:text-red-700 p-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
            </button>
        `,e.appendChild(o)})};window.updateMenuItem=(e,t,n)=>{a.menu.items[e][t]=n};window.uploadMenuImage=async(e,t)=>{if(t.files&&t.files[0])try{const n=await d(t.files[0]);a.menu.items[e].image=n,i()}catch(n){alert("L·ªói upload ·∫£nh: "+n.message)}};window.deleteMenuItem=e=>{confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m√≥n n√†y?")&&(a.menu.items.splice(e,1),i())};window.addMenuItem=()=>{a.menu.items.push({id:Date.now(),name:"M√≥n M·ªõi",description:"M√¥ t·∫£ m√≥n ƒÉn...",price:"Li√™n h·ªá",image:"assets/img1.png",tag:"",tagColor:"primary",category:"b√°nh ng·ªçt"}),i()};const c=()=>{const e=document.getElementById("gallery-list");e.innerHTML="";const t=document.createElement("div");t.className="flex flex-col items-center justify-center bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg aspect-square cursor-pointer hover:bg-gray-200 transition-colors",t.onclick=()=>document.getElementById("gallery-upload-input").click(),t.innerHTML=`
        <svg class="w-10 h-10 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
        <span class="text-sm text-gray-500 font-medium">Th√™m ·∫¢nh M·ªõi</span>
        <input type="file" id="gallery-upload-input" class="hidden" accept="image/*" onchange="uploadGalleryImage(this)">
    `,e.appendChild(t),a.gallery.images.forEach((n,o)=>{const r=document.createElement("div");r.className="relative group aspect-square rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",r.innerHTML=`
            <img src="${n}" class="w-full h-full object-cover">
            <button onclick="deleteGalleryItem(${o})" class="absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <input type="text" value="${n}" class="absolute bottom-0 left-0 w-full p-1 text-xs bg-white/90 outline-none opacity-0 group-hover:opacity-100 transition-opacity" onchange="updateGalleryItem(${o}, this.value)">
        `,e.appendChild(r)})};window.uploadGalleryImage=async e=>{if(e.files&&e.files[0])try{const t=await d(e.files[0]);a.gallery.images.push(t),c()}catch(t){alert("L·ªói upload ·∫£nh: "+t.message)}};window.deleteGalleryItem=e=>{confirm("X√≥a ·∫£nh n√†y?")&&(a.gallery.images.splice(e,1),c())};window.updateGalleryItem=(e,t)=>{a.gallery.images[e]=t,c()};window.addGalleryItem=()=>{const e=prompt("Nh·∫≠p URL h√¨nh ·∫£nh (ho·∫∑c d√πng n√∫t Upload):");e&&(a.gallery.images.push(e),c())};const I=()=>{document.getElementById("about-title-input").value=a.about.title,document.getElementById("about-image-input").value=a.about.image,document.getElementById("about-content-input").value=a.about.paragraphs.join(`
`),document.getElementById("about-title-input").onchange=t=>a.about.title=t.target.value,document.getElementById("about-image-input").onchange=t=>a.about.image=t.target.value,document.getElementById("about-content-input").onchange=t=>a.about.paragraphs=t.target.value.split(`
`).filter(n=>n.trim()!=="");const e=document.getElementById("about-image-file");e&&(e.onchange=async t=>{if(t.target.files&&t.target.files[0])try{const n=await d(t.target.files[0]);a.about.image=n,document.getElementById("about-image-input").value=n,alert("ƒê√£ c·∫≠p nh·∫≠t ·∫£nh th√†nh c√¥ng!")}catch(n){alert("L·ªói: "+n)}})},E=()=>{document.getElementById("contact-address-input").value=a.contact.address,document.getElementById("contact-phone-input").value=a.contact.phone,document.getElementById("contact-hours-input").value=a.contact.hours,document.getElementById("contact-map-input").value=a.contact.mapEmbed,document.getElementById("contact-address-input").onchange=e=>a.contact.address=e.target.value,document.getElementById("contact-phone-input").onchange=e=>a.contact.phone=e.target.value,document.getElementById("contact-hours-input").onchange=e=>a.contact.hours=e.target.value,document.getElementById("contact-map-input").onchange=e=>a.contact.mapEmbed=e.target.value};document.getElementById("save-btn").addEventListener("click",()=>{try{localStorage.setItem("siteData",JSON.stringify(a)),alert("ƒê√£ l∆∞u thay ƒë·ªïi v√†o tr√¨nh duy·ªát!")}catch(e){e.name==="QuotaExceededError"?alert("L·ªói: Dung l∆∞·ª£ng l∆∞u tr·ªØ ƒë√£ ƒë·∫ßy! H√£y th·ª≠ x√≥a b·ªõt ·∫£nh ho·∫∑c d√πng ·∫£nh nh·ªè h∆°n."):alert("L·ªói khi l∆∞u: "+e.message)}});document.getElementById("reset-btn").addEventListener("click",()=>{confirm("B·∫°n c√≥ ch·∫Øc mu·ªën reset v·ªÅ m·∫∑c ƒë·ªãnh kh√¥ng? M·ªçi thay ƒë·ªïi ch∆∞a xu·∫•t file s·∫Ω m·∫•t.")&&(localStorage.removeItem("siteData"),location.reload())});document.getElementById("export-btn").addEventListener("click",()=>{const e="export const initialData = "+JSON.stringify(a,null,4)+";",t=new Blob([e],{type:"text/javascript;charset=utf-8"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="data.js",document.body.appendChild(o),o.click(),document.body.removeChild(o)});
